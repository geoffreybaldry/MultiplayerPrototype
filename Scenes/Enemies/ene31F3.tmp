[gd_scene load_steps=10 format=3 uid="uid://c8sydgqm2ae4h"]

[ext_resource type="Script" path="res://Scenes/Enemies/enemy_bi_ped.gd" id="1_jlir7"]
[ext_resource type="Script" path="res://Scripts/StateMachines/state_machine.gd" id="2_inmwv"]
[ext_resource type="Script" path="res://Scenes/Enemies/idle_enemy_action_state.gd" id="3_yd33y"]
[ext_resource type="Script" path="res://Scenes/Enemies/attack_enemy_action_state.gd" id="4_d3st4"]
[ext_resource type="Script" path="res://Scenes/Enemies/chase_enemy_action_state.gd" id="4_i1kfk"]
[ext_resource type="Script" path="res://Scenes/Enemies/hurt_enemy_action_state.gd" id="6_ruj0q"]
[ext_resource type="Script" path="res://Scenes/Enemies/death_enemy_action_state.gd" id="7_0r0s6"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_2l2oc"]

[sub_resource type="SceneReplicationConfig" id="SceneReplicationConfig_tmdwt"]
properties/0/path = NodePath(".:position")
properties/0/spawn = true
properties/0/sync = true
properties/0/watch = false

[node name="Enemy_BiPed" type="CharacterBody3D" groups=["Enemy"]]
collision_layer = 32
collision_mask = 39
script = ExtResource("1_jlir7")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_2l2oc")

[node name="MultiplayerSynchronizer" type="MultiplayerSynchronizer" parent="."]
replication_config = SubResource("SceneReplicationConfig_tmdwt")

[node name="Visual" type="Node3D" parent="."]

[node name="State" type="Label3D" parent="Visual"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.66332, 0)
billboard = 1
text = "State"

[node name="ClosestPlayerInSight" type="Label3D" parent="Visual"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.40429, 0)
billboard = 1
text = "Closest Player"

[node name="SoundEffects" type="Node" parent="."]

[node name="Timers" type="Node" parent="."]

[node name="StateMachines" type="Node" parent="."]

[node name="EnemyActionStateMachine" type="Node" parent="StateMachines" node_paths=PackedStringArray("current_state")]
script = ExtResource("2_inmwv")
current_state = NodePath("IdleEnemyActionState")

[node name="IdleEnemyActionState" type="Node" parent="StateMachines/EnemyActionStateMachine" node_paths=PackedStringArray("actor")]
script = ExtResource("3_yd33y")
actor = NodePath("../../..")

[node name="ChaseEnemyActionState" type="Node" parent="StateMachines/EnemyActionStateMachine" node_paths=PackedStringArray("actor")]
script = ExtResource("4_i1kfk")
actor = NodePath("../../..")

[node name="AttackEnemyActionState" type="Node" parent="StateMachines/EnemyActionStateMachine" node_paths=PackedStringArray("actor")]
script = ExtResource("4_d3st4")
actor = NodePath("../../..")

[node name="HurtEnemyActionState" type="Node" parent="StateMachines/EnemyActionStateMachine" node_paths=PackedStringArray("actor")]
script = ExtResource("6_ruj0q")
actor = NodePath("../../..")

[node name="DeathEnemyActionState" type="Node" parent="StateMachines/EnemyActionStateMachine" node_paths=PackedStringArray("actor")]
script = ExtResource("7_0r0s6")
actor = NodePath("../../..")

[node name="Detector" type="Node3D" parent="."]

[node name="Area3D" type="Area3D" parent="Detector"]
collision_layer = 16

[node name="CollisionShape3D" type="CollisionShape3D" parent="Detector/Area3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)

[node name="RayCast3D" type="RayCast3D" parent="Detector"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
target_position = Vector3(0, 0, 3)
collision_mask = 5

[node name="Marker3D" type="Marker3D" parent="Detector"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]

[node name="Hurtbox" type="Area3D" parent="."]
collision_layer = 64
collision_mask = 8

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hurtbox"]

[node name="Hitbox" type="Area3D" parent="."]
collision_layer = 128
collision_mask = 256

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox"]

[connection signal="target_reached" from="NavigationAgent3D" to="StateMachines/EnemyActionStateMachine/ChaseEnemyActionState" method="_on_navigation_agent_3d_target_reached"]
